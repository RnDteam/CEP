<?xml version="1.0" encoding="UTF-8"?>
<com.ibm.ia.designer.berl:BerlRule xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:com.ibm.ia.designer.berl="http://com.ibm.ia.designer/model/berl.ecore">
  <name>DetectNonCriminalCalleeWithMoreThan1DepthAssosiaction_13122</name>
  <uuid>243e1149-51d2-49e4-a450-9581afe34652</uuid>
  <documentation><![CDATA[check that 1.3.1.2.2 and send events for  1.3.1.2.2.1 and 1.3.1.2.2.2]]></documentation>
  <locale>en_US</locale>
  <definition><![CDATA[when a criminal cellular call report occurs
definitions
    set 'nearby distance' to 10 ;
    set 'the cellular call report' to the cellular call report of this criminal cellular call report ;
    set 'the callee' to the callee of 'the cellular call report' ;
    set 'the caller' to the caller of 'the cellular call report' ;
    set 'callee organization' to the organization of the role of 'the callee' ;
    set 'timestamp' to the timestamp of 'the cellular call report' ;
    set 'nearby criminals' to the persons of 'the cellular call report'
        where the distance between 'the callee' and each person in meters is less than 'nearby distance'
        and the type of the organization of the role of each person is CRIMINAL ;
    set 'nearby buildings' to the buildings of 'the cellular call report'
        where the distance between the latest observed geometry of 'the callee' and each building in meters is less than 'nearby distance' ;
if
    the type of 'callee organization' is not CRIMINAL
    and the relationship depth between 'the callee' and 'the caller' is more than 1
then
    for each building in 'nearby buildings' :
        - emit a new dwelled building report where
            the building is this building ,
            the nearby distance in meters is 'nearby distance' ,
            the person is 'the callee' ,
            the timestamp is 'timestamp' ;
    for each person in 'nearby criminals' :
        - emit a new dwelling with criminal report where
            the suspect is 'the callee' ,
            the nearby distance in meters is 'nearby distance' ,
            the potential collaborator is this person ,
            the timestamp is 'timestamp' ;]]></definition>
</com.ibm.ia.designer.berl:BerlRule>
